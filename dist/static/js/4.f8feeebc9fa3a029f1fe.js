webpackJsonp([4],{GfJK:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("XxfO"),i=a("JA8L"),n=a("Kbff"),r=a("84iU"),l=a.n(r),o={name:"work_object",components:{bpmnModeler:n.a},data:function(){return{users:[{name:"张三",id:"zhangsan"},{name:"李四",id:"lisi"},{name:"王五",id:"wangwu"}],groups:[{name:"web组",id:"web"},{name:"java组",id:"java"},{name:"python组",id:"python"}],categorys:[{name:"OA",id:"oa"},{name:"财务",id:"finance"}],that:this,currentTab:"1",seeActive:"first",seeDialog:!1,fileList:[],data_id:"",editItemDialog:!1,file_num:0,sendObjectList:[],flag:null,record_row:{},editDeploy:{id:"",status:""},config_id:"",addDialog:!1,addForm:{name:"",des:""},editForm:{id:"",name:"",des:""},addTempItem:{id:"",poolId:"",content:[{value:"",key:"1"}],createTime:""},editTempItem:{id:"",poolId:"",content:"",createTime:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],des:[{required:!1,message:"请输入描述",trigger:"blur"}]},firstShow:!1,isOpen:!1,inner_name:"",templateId:"",deleteItemDialog:!1,deleteDialog:!1,deleteId:"",deleteItemId:"",editDialog:!1,formLabelWidth:"120px",loading:!1,total_num:0,multipleSelection:[],itemSelection:[],tableData:[],sayTimes:[],get_params:{page:1,size:20,name:"",sendId:"",status:"",type:0},seeForm:{},allUserList:[],allDepList:[],allRolesList:[],alarmList:[],conditionList:[],leakList:[],dataList:[{name:"资产负责人",id:0},{name:"告警创建人",id:1}]}},watch:{addDialog:{handler:function(e,t){e||this.$refs.addForm.resetFields()}}},mounted:function(){var e=this;this.$nextTick(function(){e.get_data()})},filters:{showField:function(e,t){var a,s;if("1"==(null===(a=t.seeForm)||void 0===a?void 0:a.sendId)){var i=t.alarmList.find(function(t){return t.value==e});return i?i.label:"--"}if("2"==(null===(s=t.seeForm)||void 0===s?void 0:s.sendId)){var n=t.leakList.find(function(t){return t.value==e});return n?n.label:"--"}},showCondition:function(e,t){var a=t.conditionList.find(function(t){return t.value===e});return a?a.name:"--"}},computed:{show_warn_type:function(){var e,t,a,s,i="";null!==(e=this.seeForm)&&void 0!==e&&null!==(t=e.endEventObj)&&void 0!==t&&t.type.length&&(null===(a=this.seeForm)||void 0===a||null===(s=a.endEventObj)||void 0===s||s.type.forEach(function(e){0==e?i+="站内消息、":1==e?i+="邮件、":2==e?i+="短信、":3==e&&(i+="蓝鲸快信、")}));return"、"===i[i.length-1]&&(i=i.slice(0,i.length-1)),i},show_warn_user:function(){var e,t,a,s,i,n=this,r="";null!==(e=this.seeForm)&&void 0!==e&&null!==(t=e.endEventObj)&&void 0!==t&&t.users.length&&(null===(s=this.seeForm)||void 0===s||null===(i=s.endEventObj)||void 0===i||i.users.forEach(function(e){0==e.userType?e.ids.forEach(function(e){var t=n.allUserList.find(function(t){return t.id==e});t&&(r+=t.chineseName+"、")}):1==e.userType?e.ids.forEach(function(e){var t=n.allDepList.find(function(t){return t.id==e});t&&(r+=t.name+"、")}):2==e.userType?e.ids.forEach(function(e){var t=n.allRolesList.find(function(t){return t.id==e});t&&(r+=t.roleName+"、")}):3==e.userType?(e.ids.forEach(function(e){var t=n.dataList.find(function(t){return t.id==e});t&&(r+=t.name+"、")}),r+=e.name+"、"):4==e.userType&&(r+="流程相关、")}));return"、"===r[r.length-1]&&(r=r.slice(0,r.length-1)),null!==(a=r)&&void 0!==a?a:""},show_warn_mes:function(){var e,t,a,s;return""===(null===(e=this.seeForm)||void 0===e?void 0:null===(t=e.endEventObj)||void 0===t?void 0:t.mes)?"--":null===(a=this.seeForm)||void 0===a?void 0:null===(s=a.endEventObj)||void 0===s?void 0:s.mes}},methods:{getStyle:function(){var e=window.screen.width;return e>=1680?{width:"220px"}:e<1680?{width:"156px"}:void 0},getSeeList:function(){var e=this;l.a.all([Object(s.h)({}),Object(s.f)({}),Object(s.g)({})]).then(l.a.spread(function(t,a,s){e.allUserList=t,e.allDepList=a,e.allRolesList=s}))},getWorkFields:function(){var e=this;l.a.all([Object(i.e)({}),Object(i.b)({}),Object(i.c)({})]).then(l.a.spread(function(t,a,s){e.alarmList=t,e.conditionList=a,e.leakList=s}))},indexMethod:function(e){return(this.get_params.page-1)*this.get_params.size+e+1},indexInnerMethod:function(e){return(this.get_inner_params.page-1)*this.get_inner_params.size+e+1},tabClick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";this.currentTab=e,"1"===e&&(this.get_params.type=0),"2"===e&&(this.get_params.type=1),this.get_data()},handleAddTemplate:function(){this.$router.push("/home/work_template/work_base")},searchCheck:function(){this.get_params.page=1,this.get_data()},searchCheckItem:function(){this.get_inner_params.page=1,this.get_Item()},get_data:function(){var e=this;this.loading=!0,this.tableData=[];var t=this.config_id=(new Date).getTime();this.get_params.page,this.get_params.name,this.get_params.sendId,this.get_params.status,this.get_params.type,this.sayTimes&&this.sayTimes.length>0&&this.sayTimes[0],this.sayTimes&&this.sayTimes.length>0&&this.sayTimes[1];a.e(19).then(a.bind(null,"dQKT")).then(function(a){if(a=a.data,e.loading=!1,e.config_id===t){e.total_num=a.totalElements;var s=a.content;s.length>0&&s.forEach(function(t){var a={};a.id=t.id,a.name=t.name,a.num=t.num,a.sendId=t.sendId,a.sendCN=t.sendCN,a.startConditionObj=t.startConditionObj,a.status=t.status,a.statusCN=t.statusCN,a.xmlName=t.xmlName,a.xml=t.xml,a.endEventObj=t.endEventObj,a.des=t.des,a.createTime=t.createTime,a.createUserId=t.createUserId,a.createUserCN=t.createUserCN,a.deploymentId=t.deploymentId,a.userIds=t.userIds,e.tableData.push(a)})}}).catch(function(t){e.loading=!1})},init:function(){this.get_sendObject(),this.getSeeList(),this.getWorkFields()},get_sendObject:function(){var e=this;Object(s.i)({}).then(function(t){e.sendObjectList=t,e.$setsessionStorage("sendObjectList",t)}).catch(function(e){})},deploymentEnvironment:function(e){var t=this;this.flag=setTimeout(function(){t.record_row={}},1e3),e.id!==this.record_row.id&&(this.record_row=e,this.editDeploy.id=e.id,e.status=1==e.status?2:1,this.submitDeployForm())},submitDeployForm:function(e){var t=this,a={id:this.editDeploy.id};Object(s.b)(a).then(function(e){0===document.getElementsByClassName("el-message").length&&t.$message({message:"状态修改成功",type:"success"})}).catch(function(e){})},handleSee:function(e){this.seeDialog=!0,this.seeForm=e},handleCopyAdd:function(e){var t=this.$deepCopy(e);t.id="",t.name=t.name+"--copy",this.$setsessionStorage("copyTemplate",t),this.$router.push("/home/work_template/work_base")},handleEdit:function(e){var t=this.$deepCopy(e);this.$setsessionStorage("editTemplate",t),this.$router.push("/home/work_template/work_base")},handleDeleteAll:function(){if(0!=this.multipleSelection.length){var e=[];this.multipleSelection.forEach(function(t){e.push(t.id)}),this.deleteId=e,this.deleteDialog=!0}else this.$message({message:"请先选择对象",type:"warning"})},handleDelete:function(e){this.deleteId=e.id,this.deleteDialog=!0},handleDeleteFun:function(){var e=this,t={id:this.deleteId};Object(s.d)(t).then(function(t){e.deleteDialog=!1,e.$message({message:"删除成功",type:"success"}),setTimeout(function(){e.get_data()},1500)}).catch(function(t){e.deleteDialog=!1})},handleSizeChange:function(e){this.get_params.size=e,this.get_data()},handleCurrentChange:function(e){this.get_params.page=e,this.get_data()},handleSelectionChange:function(e){this.multipleSelection=e}},beforeDestroy:function(){this.flag&&(clearTimeout(this.flag),this.flag=null)}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"event event-wrapper"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.firstShow,expression:"!firstShow"}],staticClass:"w100"},[a("div",{staticClass:"tab-button ub"},[a("div",{staticClass:"work-btn",class:{"tab-active":"1"===e.currentTab},on:{click:function(t){return e.tabClick("1")}}},[e._v("工单模板")]),e._v(" "),a("div",{staticClass:"draft-btn",class:{"tab-active":"2"===e.currentTab},on:{click:function(t){return e.tabClick("2")}}},[e._v("草 稿")])]),e._v(" "),a("div",{staticClass:"ub w100 search-area",staticStyle:{"box-sizing":"border-box"}},[a("div",{staticClass:"ub event-content w100"},[a("div",{staticClass:"ub ub-ver ub-ac ub-f1"},[a("el-row",{staticClass:"w100",staticStyle:{"border-radius":"0 0 5px 5px"},attrs:{type:"flex",align:"middle"}},[a("el-col",{staticClass:"event-btn-col",attrs:{span:6}},[a("el-form",{attrs:{model:e.get_params}},[a("el-form-item",{attrs:{label:"模板名称：","label-width":"85px"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchCheck.apply(null,arguments)}},model:{value:e.get_params.name,callback:function(t){e.$set(e.get_params,"name",t)},expression:"get_params.name"}})],1)],1)],1),e._v(" "),a("el-col",{staticClass:"event-btn-col",attrs:{span:6}},[a("el-form",{attrs:{model:e.get_params}},[a("el-form-item",{attrs:{label:"发起对象：","label-width":"85px"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",size:"small",placeholder:"请选择"},model:{value:e.get_params.sendId,callback:function(t){e.$set(e.get_params,"sendId",t)},expression:"get_params.sendId"}},e._l(e.sendObjectList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),"1"==e.currentTab?a("el-col",{staticClass:"event-btn-col",attrs:{span:6}},[a("el-form",{attrs:{model:e.get_params}},[a("el-form-item",{attrs:{label:"模板状态：","label-width":"85px"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:"",size:"small"},model:{value:e.get_params.status,callback:function(t){e.$set(e.get_params,"status",t)},expression:"get_params.status"}},[a("el-option",{attrs:{label:"未启用",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"已启用",value:"1"}})],1)],1)],1)],1):e._e(),e._v(" "),a("el-col",{staticClass:"event-btn-col",attrs:{span:6}},[a("el-form",{attrs:{model:e.get_params}},[a("el-form-item",{attrs:{label:"创建时间：","label-width":"90px"}},[a("el-date-picker",{style:e.getStyle(),attrs:{clearable:"",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.sayTimes,callback:function(t){e.sayTimes=t},expression:"sayTimes"}})],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"ub"},[a("searchBtn",{attrs:{title:"搜 索"},on:{click:e.searchCheck}})],1)])]),e._v(" "),a("div",{staticClass:"attendance-list table-area"},[a("div",{staticClass:"ub ub-pj w100"},[a("div",{staticClass:"list-tips"},[e._v("列表内容")]),e._v(" "),a("div",[a("addBtn",{attrs:{icon:"el-icon-plus",title:"添加模板"},on:{click:e.handleAddTemplate}})],1)]),e._v(" "),1!=e.get_params.type?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:1,ref:"multipleTable",staticClass:"bigTable full-table",attrs:{data:e.tableData,border:"",stripe:"","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"index",width:"50",index:e.indexMethod,label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"模板名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"sendCN",label:"发起对象","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[1==s.status?a("span",{staticStyle:{color:"#00ff00"}},[e._v("已启用")]):e._e(),e._v(" "),2==s.status?a("span",{staticStyle:{color:"rgba(255,255,255,0.5)"}},[e._v("未启用")]):e._e()]}}],null,!1,710471084)}),e._v(" "),a("el-table-column",{attrs:{prop:"userIds",label:"适用范围",width:"260","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return e._l(s.userIds,function(t,i){return a("span",{key:i},[e._v(e._s(t.name)+"\n                                "),i!==s.userIds.length-1?a("span",[e._v("，")]):e._e()])})}}],null,!1,4039198864)}),e._v(" "),a("el-table-column",{attrs:{prop:"num",label:"使用次数",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("span",{staticStyle:{color:"#00ffe4"}},[e._v(e._s(s.num))])]}}],null,!1,4189860414)}),e._v(" "),a("el-table-column",{attrs:{prop:"createUserCN",label:"创建人",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"是否启用",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("div",{staticClass:"switch-wrapper",class:{yes:1==s.status,no:2==s.status},on:{click:function(t){return e.deploymentEnvironment(s)}}},[a("div",{staticClass:"ub ub-ac ub-pj"},[a("div",{staticStyle:{"margin-left":"-1px"}},[e._v("是")]),e._v(" "),a("div",[e._v("否")])]),e._v(" "),a("div",{staticClass:"circle"})])]}}],null,!1,263482915)}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleCopyAdd(t.row)}}},[e._v("复制并新建")]),e._v(" "),a("el-button",{staticStyle:{color:"#fff584"},attrs:{type:"text"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编 辑")]),e._v(" "),a("el-button",{staticStyle:{color:"#ff7200"},attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删 除")])]}}],null,!1,283884004)})],1):e._e(),e._v(" "),1==e.get_params.type?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:2,ref:"multipleTable",staticClass:"bigTable full-table",attrs:{data:e.tableData,border:"",stripe:"","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"index",width:"50",index:e.indexMethod,label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"模板名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"sendCN",label:"发起对象","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userIds",label:"适用范围",width:"260","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return e._l(s.userIds,function(t,i){return a("span",{key:i},[e._v(e._s(t.name)+"\n                                "),i!==s.userIds.length-1?a("span",[e._v("，")]):e._e()])})}}],null,!1,4039198864)}),e._v(" "),a("el-table-column",{attrs:{prop:"num",label:"使用次数",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("span",{staticStyle:{color:"#00ffe4"}},[e._v(e._s(s.num))])]}}],null,!1,4189860414)}),e._v(" "),a("el-table-column",{attrs:{prop:"createUserCN",label:"创建人",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"#fff584"},attrs:{type:"text"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑草稿")]),e._v(" "),a("el-button",{staticStyle:{color:"#ff7200"},attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除草稿")])]}}],null,!1,3854377612)})],1):e._e(),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.get_params.page,"page-sizes":[20,30,40,50],"page-size":e.get_params.size,layout:"total, sizes, prev, pager, next","prev-text":"上一页","next-text":"下一页",total:e.total_num},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"删除资源",visible:e.deleteDialog,width:"30%","custom-class":"attendance-dialog"},on:{"update:visible":function(t){e.deleteDialog=t}}},[a("span",[e._v("确定删除吗？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("searchBtn",{attrs:{title:"确 定"},on:{click:e.handleDeleteFun}}),e._v(" "),a("cancle-btn",{attrs:{title:"取 消"},on:{click:function(t){e.deleteDialog=!1}}})],1)]),e._v(" "),a("el-drawer",{attrs:{visible:e.seeDialog,direction:"rtl",size:"850px"},on:{"update:visible":function(t){e.seeDialog=t}}},[a("div",{staticClass:"drawer-content"},[a("div",{staticStyle:{position:"absolute",left:"0",top:"0",width:"100%",height:"100%","overflow-y":"auto",padding:"20px","box-sizing":"border-box"}},[a("div",{staticClass:"ub ub-pj w100"},[a("div",{staticClass:"list-tips"},[e._v("\n                            "+e._s("模板名称")+"\n                        ")]),e._v(" "),a("div",[a("i",{staticClass:"el-icon-close",staticStyle:{color:"#00b3ca","font-size":"20px",cursor:"pointer"},on:{click:function(t){e.seeDialog=!1}}})])]),e._v(" "),a("el-tabs",{model:{value:e.seeActive,callback:function(t){e.seeActive=t},expression:"seeActive"}},[a("el-tab-pane",{attrs:{label:"详情信息",name:"first"}},[a("p",{staticClass:"box-title"},[e._v("基本信息")]),e._v(" "),a("div",{staticClass:"baseinfo-box"},[a("el-row",{staticStyle:{margin:"20px 0"},attrs:{type:"flex",justify:"start"}},[a("div",{staticClass:"ub",staticStyle:{width:"33%"}},[a("div",{staticClass:"label"},[e._v("模板名称：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val"},[e._v(e._s(e._f("NullStr")(e.seeForm.name)))])]),e._v(" "),a("div",{staticClass:"ub",staticStyle:{width:"33%"}},[a("div",{staticClass:"label"},[e._v("发起对象：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val"},[e._v(e._s(e._f("NullStr")(e.seeForm.sendCN)))])]),e._v(" "),a("div",{staticClass:"ub",staticStyle:{width:"33%"}},[a("div",{staticClass:"label"},[e._v("模板状态：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val"},[1==e.seeForm.status?a("span",{staticStyle:{color:"#00ff00"}},[e._v("已启用")]):e._e(),e._v(" "),2==e.seeForm.status?a("span",{staticStyle:{color:"rgba(255,255,255,0.5)"}},[e._v("未启用")]):e._e()])])]),e._v(" "),a("el-row",{staticStyle:{margin:"20px 0"},attrs:{type:"flex",justify:"start"}},[a("div",{staticClass:"ub",staticStyle:{width:"33%"}},[a("div",{staticClass:"label"},[e._v("使用次数：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val"},[a("span",{staticStyle:{color:"#00ffe4"}},[e._v(e._s(e._f("NullStr")(e.seeForm.num)))])])]),e._v(" "),a("div",{staticClass:"ub",staticStyle:{width:"33%"}},[a("div",{staticClass:"label"},[e._v("创建人：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val"},[e._v(e._s(e._f("NullStr")(e.seeForm.createUserCN)))])]),e._v(" "),a("div",{staticClass:"ub",staticStyle:{width:"33%"}},[a("div",{staticClass:"label"},[e._v("创建时间：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val"},[e._v(e._s(e._f("NullStr")(e.seeForm.createTime)))])])]),e._v(" "),a("el-row",{staticStyle:{margin:"20px 0"},attrs:{type:"flex",justify:"start"}},[a("div",{staticClass:"ub"},[a("div",{staticClass:"label"},[e._v("适用范围：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val"},e._l(e.seeForm.userIds,function(t,s){return a("span",{key:s},[e._v(e._s(t.name)+"\n                                             "),s!==e.seeForm.userIds.length-1?a("span",[e._v("，")]):e._e()])}),0)])]),e._v(" "),a("el-row",{staticStyle:{margin:"20px 0"},attrs:{type:"flex",justify:"start"}},[a("div",{staticClass:"ub"},[a("div",{staticClass:"label"},[e._v("工单描述：")]),e._v(" "),a("div",{staticClass:"ub ub-f1 line1 label-val",domProps:{innerHTML:e._s(e.seeForm.des)}})])])],1),e._v(" "),a("p",{staticClass:"box-title"},[e._v("触发条件")]),e._v(" "),a("div",{staticClass:"condition-box"},e._l(e.seeForm.startConditionObj,function(t,s){return a("div",{key:s,staticClass:"single-condition"},[0!=s?a("div",{staticStyle:{color:"#fff584","font-size":"12px",height:"21px","line-height":"21px","margin-bottom":"10px"}},[e._v("或（or）")]):e._e(),e._v(" "),a("div",{staticClass:"ub ub-ver"},e._l(t.and,function(t,s){return a("div",{key:s,staticClass:"part-condition ub ub-ac"},[a("span",{staticClass:"condition_black"},[e._v("且（and）")]),e._v(" "),a("span",{staticClass:"condition_white"},[e._v(e._s(e._f("showField")(t.field,e.that)))]),e._v(" "),a("span",{staticClass:"condition_black"},[e._v(e._s(e._f("showCondition")(t.condition,e.that)))]),e._v(" "),a("span",{staticClass:"condition_white"},[e._v(e._s(t.val||"--"))])])}),0)])}),0),e._v(" "),a("p",{staticClass:"box-title"},[e._v("结束工单后动作")]),e._v(" "),a("div",{staticClass:"finish-box"},[a("div",{staticClass:"warn-wrapper"},[a("div",{staticClass:"ub ub-pj ub-ac"},[a("p",{staticStyle:{"font-size":"12px",color:"#00ffff"}},[e._v("提醒")]),e._v(" "),a("p",[a("i",{staticClass:"iconfont icon-xiugai",staticStyle:{"font-size":"12px",color:"#00ffff"}}),e._v(" "),a("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"12px",color:"#00ffff"}})])]),e._v(" "),a("div",[a("p",{staticClass:"warn-top"},[e._v("提醒方式：")]),e._v(" "),a("p",{staticClass:"warn-body"},[e._v(e._s(e.show_warn_type||"--"))]),e._v(" "),a("p",{staticClass:"warn-top"},[e._v("提醒人员范围：")]),e._v(" "),a("p",{staticClass:"warn-body"},[e._v(e._s(e.show_warn_user||"--"))]),e._v(" "),a("p",{staticClass:"warn-top"},[e._v("提醒内容：")]),e._v(" "),a("p",{staticClass:"warn-body",domProps:{innerHTML:e._s(e.show_warn_mes)}})])])])]),e._v(" "),a("el-tab-pane",{attrs:{label:"流程详情",name:"second"}})],1),e._v(" "),"second"==e.seeActive?a("div",{staticClass:"w100 pic-wrapper",staticStyle:{color:"#fff"}},[a("bpmn-modeler",{ref:"refNode",attrs:{xml:e.seeForm.xml,users:e.users,groups:e.groups,categorys:e.categorys,"is-view":!1}})],1):e._e()],1)])])],1)},staticRenderFns:[]};var d=a("C7Lr")(o,c,!1,function(e){a("vZ6m"),a("q8mk")},"data-v-47ea599c",null);t.default=d.exports},Kbff:function(e,t,a){"use strict";a("Q8Xg");var s=a("0d4u"),i=a("xgxr"),n=a("i0Lz"),r=a("d7gU"),l=a("xds+"),o=a.n(l),c=a("C/00"),d=a("/76X"),u=a.n(d);function v(e,t,a,s,i,n,r){try{var l=e[n](r),o=l.value}catch(e){return void a(e)}l.done?t(o):Promise.resolve(o).then(s,i)}function p(e){return function(){var t=this,a=arguments;return new Promise(function(s,i){var n=e.apply(t,a);function r(e){v(n,s,i,r,l,"next",e)}function l(e){v(n,s,i,r,l,"throw",e)}r(void 0)})}}var m={name:"WorkflowBpmnModeler",components:{panel:i.a,VueAceEditor:o.a},props:{xml:{type:String,default:""},users:{type:Array,default:function(){return[]}},groups:{type:Array,default:function(){return[]}},categorys:{type:Array,default:function(){return[]}},isView:{type:Boolean,default:!1},workStatus:{type:Boolean,default:!1},currentWorkIds:{type:Array,default:function(){return[]}}},data:function(){return{nodeName:"",process:{xml:""},xmlVisible:!1,modeler:null,taskList:[],zoom:1,nodeList:[]}},watch:{xml:function(e){e&&this.createNewDiagram(e)}},mounted:function(){this.modeler=new c.a({container:this.$refs.canvas,bpmnRenderer:{defaultStrokeColor:"#fff"},additionalModules:[{translate:["value",s.a]}],moddleExtensions:{camunda:u.a}}),this.xml?this.createNewDiagram(this.xml):this.newDiagram(),this.addBpmnListener()},methods:{onCopy:function(){this.$message({message:"复制成功",type:"success"})},addBpmnListener:function(){var e=this;this.modeler.on("commandStack.changed",function(){e.saveDiagram(function(t,a){var s=e.$getsessionStorage("processId");e.$emit("getNewXMLInFo",{xml:a,name:s})})})},saveDiagram:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){var s,i,n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.modeler.saveXML({format:!0});case 2:s=a.sent,i=s.err,n=s.xml,e(i,n);case 6:case"end":return a.stop()}},a)}))()},editorInit:function(){a("aDfU"),a("kum0"),a("KFFf")},newDiagram:function(){this.createNewDiagram(Object(r.a)())},fitViewport:function(){this.zoom=this.modeler.get("canvas").zoom("fit-viewport");var e=document.querySelector(".flow-containers .viewport").getBBox(),t=this.modeler.get("canvas").viewbox(),a=e.x+e.width/2-65,s=e.y+e.height/2;this.modeler.get("canvas").viewbox({x:a-t.width/2,y:s-t.height/2,width:t.width,height:t.height}),this.zoom=e.width/t.width*1.8},createNewDiagram:function(e){var t=this;return p(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=e.replace(/<!\[CDATA\[(.+)]]>/g,"&lt;![CDATA[$1]]&gt;"),a.prev=1,a.next=4,t.modeler.importXML(e);case 4:t.adjustPalette(),t.fitViewport(),t.currentWorkIds.forEach(function(e){t.addOverLay(e)}),t.workStatus&&t.addOverLay(""),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1);case 13:case"end":return a.stop()}},a,null,[[1,10]])}))()},addOverLay:function(e){var t=this.modeler.get("elementRegistry");!this.workStatus&&(this.nodeList=t.filter(function(e){return"bpmn:UserTask"===e.type||"bpmn:Task"===e.type||"bpmn:ServiceTask"===e.type})),this.workStatus&&(this.nodeList=t.filter(function(e){return"bpmn:EndEvent"===e.type}));var a=this.modeler.get("overlays");this.workStatus&&(e=this.nodeList[0].id);var s,i=t.get(e);i&&(s=48==i.width?$('<div class="highlight-overlay users"></div>').css({width:i.width,height:i.height}):40==i.width?$('<div class="highlight-overlay over"></div>').css({width:i.width,height:i.height}):$('<div class="highlight-overlay"></div>').css({width:i.width,height:i.height,background:"#f4c222"}),a.add(e,{position:{top:0,left:0},html:s}));this.overlayClick()},overlayClick:function(){var e=this;$(".djs-container").on("click",".djs-overlays",function(t){var a=t.target.parentElement.parentElement.getAttribute("data-container-id"),s=e.nodeList.filter(function(e){return e.id===a})[0];e.nodeName=s?s.businessObject.name:""})},addEventBusListener:function(){var e=this;this.modeler.get("eventBus").on("element.click",function(t){var a=t.element;if(a.parent)return!(!t||"bpmn:Process"===a.type)&&void(e.nodeName=a.businessObject.name)})},adjustPalette:function(){$(".bjs-powered-by").css("display","none");try{var e=this.$refs.canvas.children[0].children[1].children[4],t={width:"100px",padding:"5px",left:"20px",borderRadius:0};for(var a in t)e.style[a]=t[a];var s=e.children[0].children;for(var i in s[0].style.display="none",s){var r=s[i];for(var l in r.children){var o=r.children[l],c={display:"flex",justifyContent:"center",alignItems:"center",width:"100%",boxSizing:"border-box",padding:"5px"};if(o.className&&o.dataset&&-1!==o.className.indexOf("entry")){var d=(new n.a).getControl(o.dataset.action);for(var u in o.innerHTML='<div style="width:30px;height:30px;" class="'+d.icon+'"></div><div class="tool-text" style="font-size: 14px;font-weight:500;margin-left:10px;">'+d.title+"</div>",c)o.style[u]=c[u]}}}}catch(e){}},fillColor:function(){var e=this,t=this.modeler.get("canvas");this.modeler._definitions.rootElements[0].flowElements.forEach(function(a){if("bpmn:UserTask"===a.$type){var s,i=e.taskList.find(function(e){return e.key===a.id})||{completed:!0},n=e.taskList.find(function(e){return!e.completed}),r=e.taskList[e.taskList.length-1];if(i)t.addMarker(a.id,i.completed?"highlight":"highlight-todo"),null===(s=a.outgoing)||void 0===s||s.forEach(function(s){var l=e.taskList.find(function(e){return e.key===s.targetRef.id});l?t.addMarker(s.id,l.completed?"highlight":"highlight-todo"):"bpmn:ExclusiveGateway"===s.targetRef.$type?(t.addMarker(s.id,i.completed?"highlight":"highlight-todo"),t.addMarker(s.targetRef.id,i.completed?"highlight":"highlight-todo")):"bpmn:EndEvent"===s.targetRef.$type&&(n||r.key!==a.id||(t.addMarker(s.id,"highlight"),t.addMarker(s.targetRef.id,"highlight")),i.completed||(t.addMarker(s.id,"highlight-todo"),t.addMarker(s.targetRef.id,"highlight-todo")))})}else"bpmn:ExclusiveGateway"===a.$type&&a.outgoing.forEach(function(a){var s=e.taskList.find(function(e){return e.key===a.targetRef.id});s&&t.addMarker(a.id,s.completed?"highlight":"highlight-todo")});"bpmn:StartEvent"===a.$type&&a.outgoing.forEach(function(s){if(e.taskList.find(function(e){return e.key===s.targetRef.id}))return t.addMarker(s.id,"highlight"),void t.addMarker(a.id,"highlight")})})},getProcess:function(){var e=this.getProcessElement();return{id:e.id,name:e.name,category:e.$attrs["camunda:processCategory"]}},getProcessElement:function(){return this.modeler.getDefinitions().rootElements[0]},saveXML:function(){var e=arguments,t=this;return p(regeneratorRuntime.mark(function a(){var s,i,n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=e.length>0&&void 0!==e[0]&&e[0],a.prev=1,a.next=4,t.modeler.saveXML({format:!0});case 4:return i=a.sent,n=(n=(n=i.xml).replace(/&lt;/g,"<")).replace(/&gt;/g,">"),s&&t.downloadFile("".concat(t.getProcessElement().name,".bpmn20.xml"),n,"application/xml"),a.abrupt("return",n);case 12:a.prev=12,a.t0=a.catch(1);case 15:case"end":return a.stop()}},a,null,[[1,12]])}))()},saveImg:function(){var e=arguments,t=this;return p(regeneratorRuntime.mark(function a(){var s,i,n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.length>0&&void 0!==e[0]?e[0]:"svg",s=e.length>1&&void 0!==e[1]&&e[1],a.prev=2,a.next=5,t.modeler.saveSVG({format:!0});case 5:return i=a.sent,n=i.svg,s&&t.downloadFile(t.getProcessElement().name,n,"image/svg+xml"),a.abrupt("return",n);case 11:a.prev=11,a.t0=a.catch(2);case 14:case"end":return a.stop()}},a,null,[[2,11]])}))()},save:function(){var e=this;return p(regeneratorRuntime.mark(function t(){var a,s,i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.getProcess(),t.next=3,e.saveXML();case 3:return s=t.sent,t.next=6,e.saveImg();case 6:i=t.sent,n={process:a,xml:s,svg:i},e.$emit("save",n),window.parent.postMessage(n,"*");case 11:case"end":return t.stop()}},t)}))()},preView:function(){var e=this;return p(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.xmlVisible=!0,t.next=3,e.saveXML();case 3:a=t.sent,e.process.xml=a;case 5:case"end":return t.stop()}},t)}))()},openBpmn:function(e){var t=this,a=new FileReader;return a.readAsText(e,"utf-8"),a.onload=function(){t.createNewDiagram(a.result)},!1},downloadFile:function(e,t,a){var s=document.createElement("a"),i=window.URL.createObjectURL(new Blob([t],{type:a}));s.href=i,s.download=e,s.click(),window.URL.revokeObjectURL(i)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isView,expression:"isView"}],staticClass:"flow-containers",class:{"view-mode":e.isView}},[a("el-container",{staticStyle:{height:"100%"}},[a("el-container",{staticStyle:{"align-items":"stretch"}},[a("el-main",{staticStyle:{padding:"0"}},[a("div",{ref:"canvas",staticClass:"canvas detail-box"})])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.xmlVisible,title:"XML",fullscreen:!1,top:"10vh"},on:{"update:visible":function(t){e.xmlVisible=t}}},[a("vue-ace-editor",{attrs:{lang:"xml",theme:"chrome",width:"100%",height:"400",options:{wrap:!0,readOnly:!0}},on:{init:e.editorInit},model:{value:e.process.xml,callback:function(t){e.$set(e.process,"xml",t)},expression:"process.xml"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.process.xml,expression:"process.xml",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],attrs:{icon:"el-icon-document"}},[e._v("复 制")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-close",type:"primary"},on:{click:function(t){e.xmlVisible=!1}}},[e._v("关闭")])],1)],1)],1)},staticRenderFns:[]};var f=a("C7Lr")(m,h,!1,function(e){a("u3LR")},null,null);t.a=f.exports},q8mk:function(e,t){},u3LR:function(e,t){},vZ6m:function(e,t){}});